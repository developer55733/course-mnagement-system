<!DOCTYPE html>
<html>
<head>
    <title>Admin Panel Test</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        pre { background: #f8f9fa; padding: 10px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>üîß Admin Panel Direct Test</h1>
    <p>Testing admin panel functionality directly on debug server</p>
    
    <div class="test-section">
        <h3>üìù Create News Test</h3>
        <form id="newsForm">
            <div class="mb-3">
                <label class="form-label">News Title</label>
                <input type="text" id="newsTitle" class="form-control" value="Test News Article" required>
            </div>
            <div class="mb-3">
                <label class="form-label">News Content</label>
                <textarea id="newsContent" class="form-control" required>This is test content for debugging.</textarea>
            </div>
            <div class="mb-3">
                <label class="form-label">Category</label>
                <select id="newsCategory" class="form-control" required>
                    <option value="general">General</option>
                    <option value="academic">Academic</option>
                    <option value="events">Events</option>
                    <option value="announcements">Announcements</option>
                </select>
            </div>
            <div class="mb-3">
                <label class="form-label">Priority</label>
                <select id="newsPriority" class="form-control" required>
                    <option value="low">Low</option>
                    <option value="medium">Medium</option>
                    <option value="high">High</option>
                </select>
            </div>
            <button type="submit" class="btn btn-primary">Create News</button>
        </form>
        <div id="newsResult" class="mt-3"></div>
    </div>
    
    <div class="test-section">
        <h3>üì∫ Create Ad Test</h3>
        <form id="adForm">
            <div class="mb-3">
                <label class="form-label">Ad Title</label>
                <input type="text" id="adTitle" class="form-control" value="Test Advertisement" required>
            </div>
            <div class="mb-3">
                <label class="form-label">Ad Description</label>
                <textarea id="adDescription" class="form-control">This is a test ad for debugging.</textarea>
            </div>
            <div class="mb-3">
                <label class="form-label">Video URL</label>
                <input type="url" id="adVideoUrl" class="form-control" value="https://example.com/test-video.mp4" required>
            </div>
            <div class="mb-3">
                <label class="form-label">Redirect URL</label>
                <input type="url" id="adRedirectUrl" class="form-control" value="https://example.com" required>
            </div>
            <div class="mb-3">
                <label class="form-label">Ad Type</label>
                <select id="adType" class="form-control" required>
                    <option value="video">Video Ad</option>
                    <option value="banner">Banner Ad</option>
                    <option value="popup">Popup Ad</option>
                </select>
            </div>
            <div class="mb-3">
                <label class="form-label">Position</label>
                <select id="adPosition" class="form-control" required>
                    <option value="top">Top</option>
                    <option value="sidebar">Sidebar</option>
                    <option value="bottom">Bottom</option>
                    <option value="popup">Popup</option>
                </select>
            </div>
            <button type="submit" class="btn btn-warning">Create Ad</button>
        </form>
        <div id="adResult" class="mt-3"></div>
    </div>
    
    <div class="test-section">
        <h3>üîç Debug Information</h3>
        <div id="debugInfo"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
        // Show debug information
        function showDebugInfo() {
            const debugInfo = document.getElementById('debugInfo');
            debugInfo.innerHTML = `
                <p><strong>Current URL:</strong> ${window.location.href}</p>
                <p><strong>Host:</strong> ${window.location.hostname}</p>
                <p><strong>Port:</strong> ${window.location.port}</p>
                <p><strong>Origin:</strong> ${window.location.origin}</p>
                <p><strong>Protocol:</strong> ${window.location.protocol}</p>
                <p><strong>User Agent:</strong> ${navigator.userAgent}</p>
            `;
        }
        
        // Test news creation
        document.getElementById('newsForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const resultDiv = document.getElementById('newsResult');
            resultDiv.innerHTML = '<p>‚è≥ Creating news...</p>';
            
            try {
                const newsData = {
                    title: document.getElementById('newsTitle').value,
                    content: document.getElementById('newsContent').value,
                    category: document.getElementById('newsCategory').value,
                    priority: document.getElementById('newsPriority').value,
                    is_active: true
                };
                
                console.log('üîÑ Creating news with data:', newsData);
                
                const response = await axios.post('/api/news', newsData, {
                    headers: { 'Content-Type': 'application/json' }
                });
                
                console.log('‚úÖ News creation response:', response.data);
                
                resultDiv.innerHTML = `
                    <div class="alert alert-success">
                        <h4>‚úÖ News Created Successfully!</h4>
                        <pre>${JSON.stringify(response.data, null, 2)}</pre>
                    </div>
                `;
                
                // Reset form
                document.getElementById('newsForm').reset();
                document.getElementById('newsTitle').value = 'Test News Article';
                document.getElementById('newsContent').value = 'This is test content for debugging.';
                
            } catch (error) {
                console.error('‚ùå News creation failed:', error);
                
                resultDiv.innerHTML = `
                    <div class="alert alert-danger">
                        <h4>‚ùå News Creation Failed!</h4>
                        <p><strong>Error:</strong> ${error.message}</p>
                        <p><strong>Status:</strong> ${error.response?.status || 'No response'}</p>
                        <p><strong>Response:</strong></p>
                        <pre>${JSON.stringify(error.response?.data || 'No response data', null, 2)}</pre>
                    </div>
                `;
            }
        });
        
        // Test ad creation
        document.getElementById('adForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const resultDiv = document.getElementById('adResult');
            resultDiv.innerHTML = '<p>‚è≥ Creating ad...</p>';
            
            try {
                const adData = {
                    title: document.getElementById('adTitle').value,
                    description: document.getElementById('adDescription').value,
                    video_url: document.getElementById('adVideoUrl').value,
                    redirect_url: document.getElementById('adRedirectUrl').value,
                    ad_type: document.getElementById('adType').value,
                    position: document.getElementById('adPosition').value,
                    is_active: true,
                    auto_play: true
                };
                
                console.log('üîÑ Creating ad with data:', adData);
                
                const response = await axios.post('/api/ads', adData, {
                    headers: { 'Content-Type': 'application/json' }
                });
                
                console.log('‚úÖ Ad creation response:', response.data);
                
                resultDiv.innerHTML = `
                    <div class="alert alert-success">
                        <h4>‚úÖ Ad Created Successfully!</h4>
                        <pre>${JSON.stringify(response.data, null, 2)}</pre>
                    </div>
                `;
                
                // Reset form
                document.getElementById('adForm').reset();
                document.getElementById('adTitle').value = 'Test Advertisement';
                document.getElementById('adDescription').value = 'This is a test ad for debugging.';
                document.getElementById('adVideoUrl').value = 'https://example.com/test-video.mp4';
                document.getElementById('adRedirectUrl').value = 'https://example.com';
                
            } catch (error) {
                console.error('‚ùå Ad creation failed:', error);
                
                resultDiv.innerHTML = `
                    <div class="alert alert-danger">
                        <h4>‚ùå Ad Creation Failed!</h4>
                        <p><strong>Error:</strong> ${error.message}</p>
                        <p><strong>Status:</strong> ${error.response?.status || 'No response'}</p>
                        <p><strong>Response:</strong></p>
                        <pre>${JSON.stringify(error.response?.data || 'No response data', null, 2)}</pre>
                    </div>
                `;
            }
        });
        
        // Initialize
        showDebugInfo();
        
        // Test server connection
        async function testServerConnection() {
            try {
                const response = await axios.get('/health');
                console.log('‚úÖ Server connection test:', response.data);
            } catch (error) {
                console.error('‚ùå Server connection test failed:', error);
            }
        }
        
        testServerConnection();
    </script>
</body>
</html>
